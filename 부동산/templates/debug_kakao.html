
    <!DOCTYPE html>
    <html lang="ko">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>카카오맵 디버깅</title>
        <style>
            body { font-family: Arial, sans-serif; margin: 0; padding: 20px; }
            #map { width: 100%; height: 500px; margin-bottom: 20px; }
            .controls { margin-bottom: 20px; }
            .log { background: #f5f5f5; padding: 10px; border-radius: 5px; height: 200px; overflow-y: auto; }
            .log p { margin: 0; padding: 2px 0; font-family: monospace; }
            button { padding: 8px 15px; margin-right: 10px; }
        </style>
    </head>
    <body>
        <h1>카카오맵 API 디버깅</h1>
        <div class="controls">
            <button onclick="checkKakaoAPI()">카카오 API 상태 확인</button>
            <button onclick="initMap()">지도 초기화</button>
            <button onclick="toggleZoom()">줌 변경</button>
        </div>
        <div id="map"></div>
        <h3>로그:</h3>
        <div class="log" id="log"></div>
        
        <script>
            // Flask에서 주입한 API 키 사용
            const KAKAO_API_KEY = "{{ kakao_api_key }}";
            
            function log(message) {
                const logElement = document.getElementById('log');
                const entry = document.createElement('p');
                entry.textContent = new Date().toLocaleTimeString() + ': ' + message;
                logElement.prepend(entry);
            }
            
            function checkKakaoAPI() {
                log('카카오 API 상태 확인 중...');
                if (window.kakao) {
                    log('✓ 카카오 API 로드됨');
                    log('version: ' + kakao.maps.version);
                } else {
                    log('✗ 카카오 API가 로드되지 않음');
                    loadKakaoAPI();
                }
            }
            
            function loadKakaoAPI() {
                log('카카오 API 로드 시도...');
                const script = document.createElement('script');
                script.type = 'text/javascript';
                script.src = 'https://dapi.kakao.com/v2/maps/sdk.js?appkey=' + KAKAO_API_KEY + '&autoload=false';
                script.onload = function() {
                    log('카카오 스크립트 로드 완료, API 로드 중...');
                    kakao.maps.load(function() {
                        log('✓ 카카오 API 로드 성공');
                    });
                };
                script.onerror = function() {
                    log('✗ 카카오 스크립트 로드 실패');
                };
                document.head.appendChild(script);
            }
            
            function initMap() {
                log('지도 초기화 시도...');
                if (!window.kakao || !window.kakao.maps) {
                    log('✗ 카카오 API가 로드되지 않아 지도를 초기화할 수 없습니다');
                    return;
                }
                
                try {
                    const mapContainer = document.getElementById('map');
                    window.map = new kakao.maps.Map(mapContainer, {
                        center: new kakao.maps.LatLng(37.5665, 126.9780),
                        level: 3
                    });
                    log('✓ 지도 초기화 성공');
                } catch (error) {
                    log('✗ 지도 초기화 실패: ' + error.message);
                }
            }
            
            function toggleZoom() {
                if (!window.map) {
                    log('✗ 지도가 초기화되지 않았습니다');
                    return;
                }
                
                const currentLevel = window.map.getLevel();
                log('현재 줌 레벨: ' + currentLevel);
                window.map.setLevel(currentLevel === 3 ? 7 : 3);
                log('줌 레벨 변경: ' + window.map.getLevel());
            }
            
            // 페이지 로드시 자동 실행
            window.onload = function() {
                log('페이지 로드됨');
                checkKakaoAPI();
            };
        </script>
    </body>
    </html>
    